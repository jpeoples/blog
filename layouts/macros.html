{% macro figure(src, txt, caption="", fullhref="", class="", imwidth=none, imheight=none, imclass="") -%}
{%- if fullhref == "" %}
    {% set full_src = src %}
{% else %}
    {% set full_src = (fullhref.split('/')[:-1]+[src]) | join('/') %}
{% endif %}

<figure {% if class != "" %}class="{{class}}"{% else %}class="s-center"{% endif %}>
    <img alt="{{txt}}" title="{{txt}}"  src="{{full_src}}" {% if imwidth %} width="{{imwidth}}" {% endif %} {%if imheight %} height="{{imheight}}" {% endif %} {% if imclass !="" %} class="{{imclass}}" {%endif%}/>
    {%- if caption != "" %}<figcaption class="s-gray">{{caption}}</figcaption>{% endif %}
</figure>
{%- endmacro %}

{% macro grouped_page_list(pages) %}
{% for year, items in pages | groupby('date.year') | reverse -%} {# Note that this reverse is necessary to keep the years sorted reverse chronologically, even when the input posts is sorted correctly. #}
  <h2 class="s-no-margin-bottom">{{year}}</h2>
  <ul class="s-no-style-list s-no-margin-vertical">
    {% for post in items %}
    <li class="s-pad-medium-vertical">
        {{caller(post)}}
    </li>
    {%endfor %}
</ul>
{% endfor %}
{% endmacro %}
